---
date: "2021-09-15"
lastmod: "2021-10-14"
draft: false
title: Systems of Linear Equations
weight: 20
bibliography: references.bib
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<p>{{% notice warning %}}
Disclaimer: None of the values used represent real-world examples.
{{% /notice %}}</p>
<div id="designing-a-system-of-linear-equations" class="section level2">
<h2>Designing a System of Linear Equations</h2>
<p>How exactly is linear algebra a key component in many optimization and
statistics problems? The answer is solving the title of this section.
In most optimization problems, we want to find the <strong>best</strong> way to allocate
resources to accomplish a goal. Not the largest/smallest nor longest/shortest
way, but <strong>optimal.</strong> Deriving from an example in <span class="citation">(<a href="#ref-Yoshida2021" role="doc-biblioref">Yoshida 2021</a>)</span>, a freight rail
company wants to transport commodities <span class="math inline">\((x_1, x_2, x_3)\)</span> from one place to
another. However, they can’t transport the entire inventory of each commodity at
once due to constraints:</p>
<ul>
<li>An order of commodities <span class="math inline">\(x_1, x_2,\)</span> and <span class="math inline">\(x_3\)</span> weigh 1, 2, and 3 tons respectively
as the locomotive weight capacity is 1,250 tons.</li>
<li>Commodities <span class="math inline">\(x_1, x_2,\)</span> and <span class="math inline">\(x_3\)</span> require 2, 1, and 4 freight cars each with
1,800 freight cars available.</li>
<li>Commodities <span class="math inline">\(x_2\)</span> and <span class="math inline">\(x_3\)</span> must total 300 units.</li>
</ul>
<p><span class="math display">\[\begin{align}
  \left[\begin{array}{@{}ccc|c@{}}
    1 &amp; 2 &amp; 3 &amp; 1250 \\
    2 &amp; 1 &amp; 4 &amp; 1800 \\
    0 &amp; 1 &amp; 1 &amp; 300
  \end{array}\right] \leftrightarrow
  \left[\begin{array}{@{}ccc|c@{}}
    x_1 &amp; 2x_3 &amp; 3x_3 &amp; 1250 \\
    2x_1 &amp; x_2 &amp; 4x_3 &amp; 1800 \\
    &amp; x_2 &amp; x_3 &amp; 300
  \end{array}\right]
\end{align}\]</span></p>
<blockquote>
<p>On the left-hand side (LHS), as indicated by the vertical line, you have a
coefficient matrix which is made up of the unit values from your commodities.
<span class="math inline">\(x_1, x_2, x_3\)</span> are referred to as <strong>decision variables</strong> since we’re trying to
figure out the quantity needed to fulfill our linear equations. On the right-hand
side (RHS), we have our <strong>constraints</strong> which are our limitations/restrictions.</p>
</blockquote>
</div>
<div id="solving-a-system-of-linear-equations" class="section level2">
<h2>Solving a System of Linear Equations</h2>
<p>Normally, this problem set would be solved through <a href="https://www.math.usm.edu/lambers/mat610/sum10/lecture4.pdf">gaussian elimination and back
substitution</a>.
Basically, you’re eliminating unknown variables by manipulating equations with
elementary row reductions. For example, if I wanted to get rid of <span class="math inline">\(x_1\)</span> in the
2nd equation, replace the 2nd equation by the sum of multiplying the 1st equation
by -2 and the 2nd equation itself. You do this repeatedly until an equation has a
single unknown.</p>
<p><span class="math display">\[\begin{align}
  \left[\begin{array}{@{}ccc|c@{}}
    -2 &amp; -4 &amp; -6 &amp; -2500 \\
    2 &amp; 1 &amp; 4 &amp; 1800 \\ \hline
    0 &amp; -3 &amp; -2 &amp; -700 
  \end{array}\right] \rightarrow
    \begin{bmatrix}
    1 &amp; 2 &amp; 3 &amp; 150 \\
    0 &amp; -3 &amp; -2 &amp; -700 \\
    0 &amp; 1 &amp; 1 &amp; 300
  \end{bmatrix} \rightarrow
  \begin{bmatrix}
    1 &amp; 2 &amp; 3 &amp; 150 \\
    0 &amp; -3 &amp; -2 &amp; -700 \\
    0 &amp; 0 &amp; 1 &amp; 200
  \end{bmatrix}
\end{align}\]</span></p>
<p><span class="math inline">\(x_3\)</span> results in 200 replacing the 3rd equation by finding the sum of equation 2 and
multiplying the 3rd equation by 3 (to eliminate <span class="math inline">\(x_2\)</span>). For the back substitution,
plug in 200 into <span class="math inline">\(x_3\)</span> in equation 2 to solve for <span class="math inline">\(x_2\)</span> resulting in 100. Plug
both values into their respective variables in equation 1 to get 450 for <span class="math inline">\(x_1\)</span>.
As a result, <span class="math inline">\((x_1, x_2, x_3) = (450, 100, 200)\)</span>. As our systems of linear equations
begin to scale in size, it isn’t practical to solve them by hand. Instead, we
will use Python’s scientific computing capabilities.</p>
<pre class="python"><code>import numpy as np
import pandas as pd
data = pd.read_csv(&#39;sample.csv&#39;)
data.head()</code></pre>
<pre><code>##       Commodity  Weight  Cars  Mixture
## 0          Coal       1     2        0
## 1    Intermodal       2     1        1
## 2  Agricultural       3     4        1</code></pre>
<p>{{% notice info %}}
The coefficient matrix is inversed to extract the coefficient values cleanly as lists.
{{% /notice %}}</p>
<pre class="python"><code>A = np.array([
  list(data[&#39;Weight&#39;]),
  list(data[&#39;Cars&#39;]),
  list(data[&#39;Mixture&#39;])
])
b = np.array([1250, 1800, 300])
def eroLEQ(matrix, constraints):
  A = matrix
  b = constraints
  
  # Check if m == n in a matrix
  if A.shape[0] == A.shape[1]:
    # Note: linalg.solve only accepts square matrices in the 1st parameter
    return np.linalg.solve(A, b)
  else:
    # lstsq for rectangular matrices
    return np.linalg.lstsq(A, b, rcond = None)[0]
eroLEQ(A, b)</code></pre>
<pre><code>## array([450., 100., 200.])</code></pre>
</div>
<div id="objective-function" class="section level2">
<h2>Objective Function</h2>
<p><span class="math display">\[\begin{align}
\text{Maximize} ~ .01x_1 + .05x_2 + .03x_3 ~~ \text{(Freight Rates)}
\end{align}\]</span></p>
<pre class="python"><code>obj_coeffs = [.01, .05, .03]
np.multiply(obj_coeffs, eroLEQ(A, b))</code></pre>
<pre><code>## array([4.5, 5. , 6. ])</code></pre>
<p>The objective function is subject to linear equality and inequality constraints
in order to maximize/minimize some value. The solution above is one of many
<strong>feasible solutions</strong> if you were looking to calculate profit. Referring to the
freight rates from each commodity (by cent per ton-mile), we find that agricultural
products (<span class="math inline">\(x_3\)</span>) generates the most profit along with a total profit of $15.50.</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Yoshida2021" class="csl-entry">
Yoshida, Ruriko. 2021. <em>Linear Algebra and Its Applications with <span>R</span></em>. Taylor; Francis.
</div>
</div>
</div>
